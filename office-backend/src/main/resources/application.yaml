logging.level.org.springframework.integration: WARN
logging.level.org.eclipse.paho: WARN

spring.cloud.gcp.project-id: "flock-office-290609"

spring:
  rsocket:
    server:
      port: ${PORT:9000}
      mapping-path: /ws
      transport: websocket

server:
  port: 8000 # server is not really used (cause of rsocket server), but this prevent a probably clash during deployments

pubsub:
  subscription-name: projects/${spring.cloud.gcp.project-id}/subscriptions/office-backend

device:
  device-state-updates.save-to-database: true

weather:
  open-weather-map:
    api-key: ${_OPEN_WEATER_MAP_API_KEY}
    latitude: 52.09266175027509
    longitude: 5.122345051397365

alerting:
  signal-alert-api:
    enabled: true
    host: ${_SIGNAL_ALERT_API_HOST}
    token: ${_SIGNAL_ALERT_API_TOKEN}
    phone-numbers: ${_SIGNAL_ALERT_API_PHONE_NUMBERS}
  rules:
    - id : "test" # change me to something else for easy testing
      type : "RAIN_CHECK_CONTACT_SENSOR"
      name : "Alert when dakterras is open and rain is imminent"
      alerting-window : 4h
      device-ids : "99f9fb1b-fe98-414c-8562-68156ed3cc12, d6464c70-3981-4db9-b2c5-5d08828ae686"
      cancel-message:
        message: "‚ÑπÔ∏è Rooftop hatch is closed (or Chuck Norris blew the rain clouds away). You don't have to worry about a wet trap anymore üëå."
        channel: SIGNAL
      alerts :
        three-hours-to-deadline:
          time-to-deadline : 3h
          message: "‚ÑπÔ∏è The rooftop hatch is open, and it's gonna rain in less than 3 hour (time to rain: ¬±{{timeToRain}}, chance: {{precipitationProb}}). Don't forget to close it."
          channel: SIGNAL
        only-two-hours-left:
          time-to-deadline: 2h
          message: "Ô∏è‚ÑπÔ∏è The rooftop hatch is open, and it's gonna rain in less than 2 hour (time to rain: ¬±{{timeToRain}}, chance: {{precipitationProb}}). Don't forget to close it."
          channel: SIGNAL
        one-hour-deadline:
          time-to-deadline : 60m
          message: "‚ö†Ô∏è WARNING: The rooftop hatch is open, and it's gonna rain in less than an hour (time to rain: ¬±{{timeToRain}}, chance: {{precipitationProb}}, volume: {{precipitationVolume}})."
          channel: SIGNAL
        alert-when-only-30-min-left:
          time-to-deadline: 30m
          message: "üö® ALARM: The rooftop hatch is open, and it's gonna rain in less than half an hour (time to rain: ¬±{{timeToRain}}). You have to close it now."
          channel: "SIGNAL"
        open-while-raining:
          time-to-deadline: 0m
          message: "üö® ALARM: The rooftop hatch is open, and it's said to be raining. Please close the door now!"
          channel: "SIGNAL"
      meta-data :
        what-ever-i-put-here: "IsParsedInAMap"
