logging.level.org.springframework.integration: WARN
logging.level.org.eclipse.paho: WARN

spring.cloud.gcp.project-id: "flock-office-290609"

spring:
  rsocket:
    server:
      port: ${PORT:9000}
      mapping-path: /ws
      transport: websocket

server:
  port: 8000 # server is not really used (cause of rsocket server), but this prevent a probably clash during deployments

pubsub:
  subscription-name: projects/${spring.cloud.gcp.project-id}/subscriptions/office-backend

weather:
  open-weather-map:
    api-key: ${_OPEN_WEATER_MAP_API_KEY}
    latitude: 52.09266175027509
    longitude: 5.122345051397365

alerting:
  signal-alert-api:
    enabled: true
    host: ${_SIGNAL_ALERT_API_HOST}
    token: ${_SIGNAL_ALERT_API_TOKEN}
    phone-numbers: ${_SIGNAL_ALERT_API_PHONE_NUMBERS}
  rules:
    - id : "test"
      type : "RAIN_CHECK_CONTACT_SENSOR"
      name : "Alert when dakterras is open and rain is imminent"
      alerting-window : 4h
      device-ids : "99f9fb1b-fe98-414c-8562-68156ed3cc12"
      alerts :
        three-hours-to-deadline:
          time-to-deadline : 3h
          message: "‚ÑπÔ∏è The rooftop terrace door is open, and it's gonna rain in less than 3 hour (time to rain: ¬±{{timeToRain}}, chance: {{precipitationProb}}). Don't forget to close it."
          channel: SIGNAL
        only-two-hours-left:
          time-to-deadline: 2h
          message: "Ô∏è‚ÑπÔ∏è The rooftop terrace door is open, and it's gonna rain in less than 2 hour (time to rain: ¬±{{timeToRain}}, chance: {{precipitationProb}}). Don't forget to close it."
          channel: SIGNAL
        one-hour-deadline:
          time-to-deadline : 60m
          message: "‚ö†Ô∏è WARNING: The rooftop terrace door is open, and it's gonna rain in less than an hour (time to rain: ¬±{{timeToRain}}, chance: {{precipitationProb}}, volume: {{precipitationVolume}})."
          channel: SIGNAL
        alert-when-only-30-min-left:
          time-to-deadline: 30m
          message: "üö® ALARM: The rooftop terrace door is open, and it's gonna rain in less than half an hour (time to rain: ¬±{{timeToRain}}). You have to close it now."
          channel: "SIGNAL"
        open-while-raining:
          time-to-deadline: 0m
          message: "üö® ALARM: The rooftop terrace door is open, and it's said to be raining. Please close the door now!"
          channel: "SIGNAL"
        every-contact-change: # special case to always trigger on contact sensor changes
          time-to-deadline: 9000m
          message: "üò±üö® Deze deuren staan nu open: {{openContactSensors}}\nGesloten deuren:\t{{closedContactSensors}}).\nTime to rain:\t{{timeToRain}}\nPrecipitation volume:\t{{precipitationVolume}}\nPrecipitation probability:\t{{precipitationProb}}"
          channel: SIGNAL
      meta-data :
        what-ever-i-put-here: "IsParsedInAMap"
